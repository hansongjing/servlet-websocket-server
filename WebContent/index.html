<head>

<script type="text/javascript" src="js/jquery-1.7.2.js">
	
</script>
<script type="text/javascript" src="js/scripts.js">
	
</script>
<script type="text/javascript" src="js/jquery.stream-1.2.js"></script>
<link rel="stylesheet" type="text/css" href="style.css" />
<script type="text/javascript">
	var ws = null;
	function sendMessage(){
		ws.send($('textarea').val());
		$('textarea').val("");
	}
	$(document)
			.ready(
					function() {
						ws = new WebSocket("ws://" + location.host
								+ "/test/Servlet");
						ws.onopen = function() {
							$('.messages')[0].innerHTML += "You are succesfully connected"
									+ "<br>";
						};
						ws.onmessage = function(m) {
							$('.messages')[0].innerHTML += m.data + "<br>";
						};
						ws.onclose = function() {

							setTimeout(function reconnet() {
								ws = new WebSocket("ws://" + location.host
										+ "/test/Servlet");
							}, 1000);

							console.log('Socket closed: reopenning');

						};
						ws.onerror = function(error) {
							console.log('Error detected: ' + error);
						};
						$('button').click(function() {
							sendMessage();
						});
					});
	$(document).keydown(function(k) {
		if(k.which == 13){
			sendMessage();
		}
		console.log(k.which);
	});
</script>
</head>

<body>
	<div class='header'>
		<B id="#id">via @dzharvis</B>
	</div>
	<div class="messages"></div>
	<div class="input">
		<textarea></textarea>
		<button>OK</button>
	</div>

</body>